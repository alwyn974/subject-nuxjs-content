---
title: "Partie 1 : Serveur de Base"
description: "Création d'un serveur de fichiers basique avec commandes list, get, put."
---

## Partie 1 : Serveur de fichiers de base

### Objectif

Créez un serveur de fichiers simple qui peut transférer des fichiers entre machines sur le réseau. Le serveur doit supporter les commandes suivantes :
- `help` : Afficher les commandes disponibles
- `list` : Lister tous les fichiers dans un répertoire de données
- `get <file>` : Télécharger un fichier (le contenu du fichier doit être encodé en base64)
- `put <file> <base64_data>` : Téléverser un fichier (aucune authentification requise pour le moment)

### Exigences

1. **Créer un répertoire de données** : Créez un répertoire nommé `data` où les fichiers seront stockés.
2. **Créer le script serveur** : Votre script doit :
   - S'exécuter dans une boucle infinie (`while true`)
   - Lire les commandes depuis stdin (une ligne à la fois)
   - Parser la commande et ses paramètres en utilisant `cut`
   - Utiliser une instruction `case` pour gérer les différentes commandes
   - Pour la commande `get` : lire le fichier depuis le répertoire `data`, l'encoder en base64 et l'envoyer
   - Pour la commande `put` : décoder les données base64 et sauvegarder le fichier dans le répertoire `data`
   - Pour la commande `list` : lister les fichiers dans le répertoire `data`
   - Pour la commande `help` : afficher les commandes disponibles
3. **Utiliser l'encodage base64** : Les fichiers doivent être transmis sous forme de chaînes encodées en base64 pour gérer les données binaires en toute sécurité sur des protocoles basés sur le texte.
4. **Rendre le script exécutable** : Utilisez `chmod +x` pour rendre votre script serveur exécutable.
5. **Exécuter le serveur** : Démarrez le serveur en utilisant : `nc -l -p <port> | ./your_server_script.sh`

::alert{type="tip"}
**Indices pour l'implémentation :**
- Utilisez `cut` pour parser les paramètres de commande depuis la ligne d'entrée
- Utilisez `basename` pour vous assurer que les chemins de fichiers ne contiennent pas de tentatives de traversée de répertoire
- Utilisez `base64 -w0` pour encoder les fichiers (l'option `-w0` empêche le retour à la ligne)
- Utilisez `base64 -d` pour décoder les données base64
- Utilisez `ls -1` pour lister les fichiers un par ligne
- N'oubliez pas d'ajouter des lignes vides (`echo ""`) après chaque réponse pour séparer clairement les sorties de commandes
- Gérez les commandes invalides gracieusement
::

### Tester votre serveur

Une fois que vous avez implémenté votre serveur de fichiers, testez-le en :
1. Démarrage du serveur sur un port
2. Connexion depuis un autre terminal (ou une autre machine si disponible)
3. Test de toutes les commandes : `help`, `list`, `get`, et `put`
4. Téléversement d'un fichier en utilisant `put`, puis listage des fichiers avec `list`, et téléchargement avec `get`
