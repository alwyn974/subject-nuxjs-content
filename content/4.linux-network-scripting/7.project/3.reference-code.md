---
title: "Annexe : Code de Référence"
description: "Solution complète du script serveur."
---

## Code Serveur de Référence

Voici une implémentation de référence du serveur de fichiers complet avec authentification.

::code-collapse
# Voir le code complet
```bash
#!/bin/bash

while true; do
	read line
	cmd=$(echo $line | cut -d' ' -f1)
	param1=$(echo $line | cut -d' ' -f2)
	param2=$(echo $line | cut -d' ' -f3)
	param3=$(echo $line | cut -d' ' -f4)
	param4=$(echo $line | cut -d' ' -f5)
	case $cmd in
		help)
			echo "help"
			echo "list"
			echo "get <file>"
			echo "put <user> <password> <file> <base64_data>"
			echo ""
			;;
		list)
			ls -1 data
			echo ""
			;;
		get)
			cat data/$(basename $param1) | base64 -w0
			echo ""
			;;
		put)
			printf "$param1:$param2" | sha256sum -c auth_db 2>/dev/null | grep -q "OK" || continue
			echo $param4 | base64 -d > data/$(basename $param3)
			echo ""
			;;
		*)
			echo "Invalid command"
			echo ""
			;;
	esac
done
```
::
